/*
 * juDragdrop Plugin - JeeUtil JavaScript Library 
 * Version 1.0
 *
 * The MIT License
 *
 * Copyright (c) 2008-2012 www.myjeeva.com
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Republic of India Patent Pending (IP): IPL-V-101-JU
 *
 * Changes Logs: please refer https://github.com/jeevatkm/jeeutil-js-library/blob/master/src/plugin/README 
 *
 */

if(typeof ju=="undefined"){alert('JeeUtil JavaScript Library: Missing Information \n\n juDragdrop-x.x plugin required "juCore-x.x plugin", kindly include.')}else{ju.dragdrop=new Object();Add(ju.dragdrop,{ver:"1.0",_zIndex:9999,group:null,isDragging:false,_oElem:null,enable:function(c,e,a,d){if(ju.isUndefined(c)){return false}c=ju.getObj(c);if(c.nodeName.equalTo("UL")){return(this.makeContainer(c,e,a,d))}else{var b=this.makeDraggable(c);this.setCallback(c,e,a,d);return b}},makeDraggable:function(b,a){if(!ju.isUndefined(a)){b.handle=b;b.handle.group=b;b.minX=b.minY=b.maxX=b.maxY=null;b.threshold=0;b.thresholdY=0;b.thresholdX=0;b._dragStart=new Function();b._dragEnd=new Function();b._drag=new Function();b.onDragStart=new Function();b.onDragEnd=new Function();b.onDrag=new Function();b.setDragHandle=this.setDragHandle;b.setDragThreshold=this.setDragThreshold;b.setDragThresholdX=this.setDragThresholdX;b.setDragThresholdY=this.setDragThresholdY;b.constrain=this.constrain;b.constVertical=this.constVertical;b.constHorizontal=this.constHorizontal;b.style.cursor="move";b.style.position="relative";b.onmousedown=this.onMouseDown}else{if(ju.isUndefined(b)){return false}b=ju.getObj(b);b.onmousedown=ju.dragdrop.invDragStart;b.onDragStart=new Function();b.onDrag=new Function();b.onDragEnd=new Function();b.style.cursor="move";b.style.position="relative";return b}},setCallback:function(b,d,a,c){if(!ju.isUndefined(b)){b.onDragStart=ju.getFunction(d);b.onDrag=ju.getFunction(a);b.onDragEnd=ju.getFunction(c);return true}else{return false}},constVertical:function(){var a=ju.dragdrop.northwestOffset(this,true);this.minX=a.x;this.maxX=a.x},constHorizontal:function(){var a=ju.dragdrop.northwestOffset(this,true);this.minY=a.y;this.maxY=a.y},constrain:function(b,a){this.minX=b.x;this.minY=b.y;this.maxX=a.x;this.maxY=a.y},setDragHandle:function(a){if(a&&a!=null){this.handle=a}else{this.handle=this}this.handle.group=this;this.onmousedown=null;this.handle.onmousedown=this.onMouseDown},setDragThreshold:function(a){if(isNaN(parseInt(a))){return}this.threshold=a},setDragThresholdX:function(a){if(isNaN(parseInt(a))){return}this.thresholdX=a},setDragThresholdY:function(a){if(isNaN(parseInt(a))){return}this.thresholdY=a},invDragStart:function(c){var b=ju.dragdrop._oElem=this;if(isNaN(parseInt(b.style.left))){b.style.left="0px"}if(isNaN(parseInt(b.style.top))){b.style.top="0px"}var a=b.style.left.toInt();var d=b.style.top.toInt();c=c?c:window.event;b.mouseX=c.clientX;b.mouseY=c.clientY;b.style._zIndex=b.style.zIndex;b.style.zIndex=ju.dragdrop._zIndex;b.style.opacity=0.7;b.onDragStart();document.onmousemove=ju.dragdrop.invDrag;document.onmouseup=ju.dragdrop.invDragEnd;return false},invDrag:function(c){var b=ju.dragdrop._oElem;var a=b.style.left.toInt();var d=b.style.top.toInt();c=c?c:window.event;b.style.left=a+(c.clientX-b.mouseX)+"px";b.style.top=d+(c.clientY-b.mouseY)+"px";b.mouseX=c.clientX;b.mouseY=c.clientY;b.onDrag();return false},invDragEnd:function(){var b=ju.dragdrop._oElem;var a=b.style.left.toInt();var c=b.style.top.toInt();b.style.zIndex=b.style._zIndex;b.style.opacity="";b.onDragEnd();document.onmousemove=null;document.onmouseup=null;ju.dragdrop._oElem=null},onMouseDown:function(d){d=ju.dragdrop.fixEvent(d);ju.dragdrop.group=this.group;var f=this.group;var b=d.windowCoordinate;var c=ju.dragdrop.northwestOffset(f,true);var g=ju.dragdrop.northwestPosition(f);var a=ju.dragdrop.southeastPosition(f);var e=ju.dragdrop.southeastOffset(f,true);f.originalOpacity=f.style.opacity;f.originalZIndex=f.style.zIndex;f.initialWindowCoordinate=b;f.dragCoordinate=b;f._dragStart(g,a,c,e);if(f.minX!=null){f.minMouseX=b.x-g.x+f.minX-c.x}if(f.maxX!=null){f.maxMouseX=f.minMouseX+f.maxX-f.minX}if(f.minY!=null){f.minMouseY=b.y-g.y+f.minY-c.y}if(f.maxY!=null){f.maxMouseY=f.minMouseY+f.maxY-f.minY}f.mouseMin=new ordinate(f.minMouseX,f.minMouseY);f.mouseMax=new ordinate(f.maxMouseX,f.maxMouseY);document.onmousemove=ju.dragdrop.onMouseMove;document.onmouseup=ju.dragdrop.onMouseUp;return false},onMouseMove:function(d){d=ju.dragdrop.fixEvent(d);var l=ju.dragdrop.group;var j=d.windowCoordinate;var g=ju.dragdrop.northwestOffset(l,true);var n=ju.dragdrop.northwestPosition(l);var b=ju.dragdrop.southeastPosition(l);var k=ju.dragdrop.southeastOffset(l,true);if(!ju.dragdrop.isDragging){if(l.threshold>0){var c=l.initialWindowCoordinate.distance(j);if(c<l.threshold){return true}}else{if(l.thresholdY>0){var f=Math.abs(l.initialWindowCoordinate.y-j.y);if(f<l.thresholdY){return true}}else{if(l.thresholdX>0){var h=Math.abs(l.initialWindowCoordinate.x-j.x);if(h<l.thresholdX){return true}}}}ju.dragdrop.isDragging=true;l.style.zIndex=ju.dragdrop._zIndex;l.style.opacity=0.7}var m=j.constrain(l.mouseMin,l.mouseMax);n=n.plus(m.minus(l.dragCoordinate));n.reposition(l);l.dragCoordinate=m;var a=ju.dragdrop.northwestOffset(l,true);l._drag(n,b,g,k);var i=ju.dragdrop.northwestOffset(l,true);if(!a.equals(i)){var e=a.minus(i);n=ju.dragdrop.northwestPosition(l).plus(e);n.reposition(l)}return false},onMouseUp:function(d){d=ju.dragdrop.fixEvent(d);var f=ju.dragdrop.group;var b=d.windowCoordinate;var c=ju.dragdrop.northwestOffset(f,true);var g=ju.dragdrop.northwestPosition(f);var a=ju.dragdrop.southeastPosition(f);var e=ju.dragdrop.southeastOffset(f,true);document.onmousemove=null;document.onmouseup=null;f._dragEnd(g,a,c,e);if(ju.dragdrop.isDragging){f.style.zIndex=f.originalZIndex;f.style.opacity=f.originalOpacity}ju.dragdrop.group=null;ju.dragdrop.isDragging=false;return false},fixEvent:function(a){if(ju.isUndefined(a)){a=window.event}ju.dragdrop._fixEvent(a);return a},firstContainer:null,lastContainer:null,makeContainer:function(d,g,c,e){g=ju.getFunction(g);c=ju.getFunction(c);e=ju.getFunction(e);if(this.firstContainer==null){this.firstContainer=this.lastContainer=d;d.previousContainer=null;d.nextContainer=null}else{d.previousContainer=this.lastContainer;d.nextContainer=null;this.lastContainer.nextContainer=d;this.lastContainer=d}d.onDragOver=new Function();d.onDragOut=new Function();var a=d.getElementsByTagName("li");var f=new Array();for(var b=0;b<a.length;b++){ju.dragdrop.makeItemDragable(a[b],g,c,e);f.push(a[b].innerHTML.trim())}d.orgVal=f.join("|");d.getOrginialValues=function(){return this.orgVal.trim().split("|")};d.getValues=function(){obj=this.getElementsByTagName("li");var j=new Array();for(var h=0;h<obj.length;h++){j[h]=obj[h].innerHTML.trim()}return j};return(d)?d:null},makeItemDragable:function(b,d,a,c){ju.dragdrop.makeDraggable(b,true);b.setDragThreshold(5);b.isOutside=false;b._dragStart=ju.dragdrop.grpDragStart;b._drag=ju.dragdrop.grpDrag;b._dragEnd=ju.dragdrop.grpDragEnd;b.onDragStart=d;b.onDrag=a;b.onDragEnd=c},grpDragStart:function(e,b,c,d){var a=ju.dragdrop.firstContainer;while(a!=null){a.northwest=ju.dragdrop.northwestOffset(a,true);a.southeast=ju.dragdrop.southeastOffset(a,true);a=a.nextContainer}this.onDragStart();this.parentNode.onDragOver()},grpDrag:function(i,a,c,g){if(this.isOutside){var b=ju.dragdrop.firstContainer;while(b!=null){if(c.inside(b.northwest,b.southeast)||g.inside(b.northwest,b.southeast)){b.onDragOver();this.isOutside=false;var f=this.parentNode;b.appendChild(this);break}b=b.nextContainer}if(this.isOutside){return}}else{if(!(c.inside(this.parentNode.northwest,this.parentNode.southeast)||g.inside(this.parentNode.northwest,this.parentNode.southeast))){this.parentNode.onDragOut();this.isOutside=true;var b=ju.dragdrop.firstContainer;while(b!=null){if(c.inside(b.northwest,b.southeast)||g.inside(b.northwest,b.southeast)){b.onDragOver();this.isOutside=false;b.appendChild(this);break}b=b.nextContainer}if(this.isOutside){var f=this.parentNode.cloneNode(false);f.appendChild(this);document.getElementsByTagName("body").item(0).appendChild(f);return}}}this.onDrag();var h=this.parentNode;var j=this;var d=ju.nextItem(j);while(d!=null&&this.offsetTop>=d.offsetTop-2){var j=d;var d=ju.nextItem(j)}if(this!=j){ju.swap(this,d);return}var j=this;var e=ju.previousItem(j);while(e!=null&&this.offsetTop<=e.offsetTop+2){var j=e;var e=ju.previousItem(j)}if(this!=j){ju.swap(this,j);return}},grpDragEnd:function(e,a,b,d){if(this.isOutside){var c=this.parentNode;return}this.onDragEnd();this.parentNode.onDragOut();this.style.top="0px";this.style.left="0px"},origin:new ordinate(0,0),northwestPosition:function(b){var a=b.style.left.toInt();var c=b.style.top.toInt();return new ordinate(isNaN(a)?0:a,isNaN(c)?0:c)},southeastPosition:function(a){return ju.dragdrop.northwestPosition(a).plus(new ordinate(a.offsetWidth,a.offsetHeight))},northwestOffset:function(a,c){var d=new ordinate(a.offsetLeft,a.offsetTop);if(!c){return d}var b=a.offsetParent;while(b){d=d.plus(new ordinate(b.offsetLeft,b.offsetTop));b=b.offsetParent}return d},southeastOffset:function(a,b){return ju.dragdrop.northwestOffset(a,b).plus(new ordinate(a.offsetWidth,a.offsetHeight))},_fixEvent:function(a){a.windowCoordinate=new ordinate(a.clientX,a.clientY)}})}function ordinate(a,b){this.x=a;this.y=b}ordinate.prototype.toString=function(){return"("+this.x+","+this.y+")"};ordinate.prototype.plus=function(a){return new ordinate(this.x+a.x,this.y+a.y)};ordinate.prototype.minus=function(a){return new ordinate(this.x-a.x,this.y-a.y)};ordinate.prototype.distance=function(c){var b=this.x-c.x;var a=this.y-c.y;return Math.sqrt(Math.pow(b,2)+Math.pow(a,2))};ordinate.prototype.max=function(b){var a=Math.max(this.x,b.x);var c=Math.max(this.y,b.y);return new ordinate(a,c)};ordinate.prototype.constrain=function(c,b){if(c.x>b.x||c.y>b.y){return this}var a=this.x;var d=this.y;if(!ju.isNull(c.x)){a=Math.max(a,c.x)}if(!ju.isNull(b.x)){a=Math.min(a,b.x)}if(!ju.isNull(c.y)){d=Math.max(d,c.y)}if(!ju.isNull(b.y)){d=Math.min(d,b.y)}return new ordinate(a,d)};ordinate.prototype.reposition=function(a){a.style.top=this.y+"px";a.style.left=this.x+"px"};ordinate.prototype.equals=function(a){if(this==a){return true}if(!a||ju.isNull(a)){return false}return this.x==a.x&&this.y==a.y};ordinate.prototype.inside=function(b,a){if((this.x>=b.x)&&(this.x<=a.x)&&(this.y>=b.y)&&(this.y<=a.y)){return true}return false};